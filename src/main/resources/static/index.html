<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MIDI Player Home</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="grid-container">
    <!-- 1. ‰∏ä‰º† MIDI -->

    <div class="card" id="uploadCard" onclick="openUploadModal()">
        <h1 class="main-title">üéº VirtualBand</h1>

        <div class="upload-body">
            <h2>üéµ Upload MIDI</h2>
            <p class="hint">Click to upload a new MIDI file</p>

            <div id="lastUpload" class="last-upload">
                <h3>üìë Recent Upload</h3>
                <p>No recent upload</p>
            </div>
        </div>
    </div>

    <!-- 2. Â∑≤‰øùÂ≠ò MIDI Êñá‰ª∂ -->
    <div class="card">
        <h2>üìÇ Saved MIDI Files</h2>
        <ul id="fileList" class="file-list"></ul>

        <div id="fileInfo" class="info-box">
            Please select a file to view details
        </div>

        <div class="controls">
            <button class="push-btn" onclick="pushMidi()">üì§ Push</button>
            <button onclick="playMidi()">‚ñ∂ Play</button>
            <button onclick="pauseMidi()">‚èπ Stop</button>
        </div>

    </div>

    <!-- 3. ÂÆûÊó∂ÊºîÂ•è -->
    <link rel="stylesheet" href="/css/realtime-play.css">

    <div class="card" id="realtime-play">
        <h2>üéπ Real-time Performance</h2>

        <!-- ÈÄâÊã©‰∏ªÁ±ª -->
        <div class="part-tabs">
            <button class="part-btn active" data-part="Piano">Piano</button>
            <button class="part-btn" data-part="Bass">Bass</button>
            <button class="part-btn" data-part="Violin">Violin</button>
            <button class="part-btn" data-part="Strings">Strings</button>
            <button class="part-btn" data-part="Drums">Drums</button>
        </div>

        <!-- ÈÄöÈÅìËÆæÁΩÆÔºàBank Âõ∫ÂÆö 0Ôºâ -->
        <div class="row">
            <div class="field">
                <label>Program Channel (0‚Äì15)</label>
                <input id="progCh" type="number" min="0" max="15" value="0">
                <small id="progChHint" class="hint">Hint: Drums automatically use channel 9</small>
            </div>
        </div>

        <!-- ÂàÜÊîØÈü≥Ëâ≤ÔºàÁÇπÂáªÂç≥ÈÄâ‰∏≠Ôºâ -->
        <div>
            <label>Variants (click to select)</label>
            <div id="variantList" class="variant-grid"></div>
        </div>

        <!-- ËÆæÁΩÆ‰πêÂô®ÔºàÂèëÈÄÅ programÔºâ -->
        <div class="row mt-10">
            <button id="btnSetProgram">Set Instrument (send program)</button>
            <span id="currentSel" class="hint ml-8"></span>
        </div>

        <hr>

        <!-- ÂèëÈü≥ÊéßÂà∂ -->
        <div class="row">
            <div class="field">
                <label>Pitch (0‚Äì127)</label>
                <input id="notePitch" type="number" min="0" max="127" value="60">
            </div>
            <div class="field">
                <label>Velocity (0‚Äì100)</label>
                <input id="noteVel" type="number" min="0" max="100" value="100">
            </div>
            <div class="field">
                <label>Note Channel (0‚Äì15)</label>
                <input id="noteCh" type="number" min="0" max="15" value="0">
            </div>
        </div>

        <div class="row">
            <button id="btnNoteOn">Start Note (note on)</button>
            <button id="btnNoteOff">End Note (note off)</button>
        </div>
    </div>




    <!-- 4. È¢ÑÁïô -->
    <div class="card">
        <h2>Band Status</h2>
        <table id="bandStatusTable" class="status-table">
            <thead>
            <tr>
                <th>Instrument</th>
                <th>Status</th>
            </tr>
            </thead>
            <tbody>
            <tr><td>Piano</td><td id="Piano" class="status">-</td></tr>
            <tr><td>Bass</td><td id="Bass" class="status">-</td></tr>
            <tr><td>Violin</td><td id="Violin" class="status">-</td></tr>
            <tr><td>Strings</td><td id="Strings" class="status">-</td></tr>
            <tr><td>Drums</td><td id="Drums" class="status">-</td></tr>
            </tbody>
        </table>
    </div>



    <!-- ‰∏ä‰º† MIDI ÂºπÁ™ó -->
    <div id="uploadModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeUploadModal()">&times;</span>
            <h2>Upload MIDI File</h2>
            <form id="uploadForm">
                <label>Song Name:</label>
                <input type="text" id="name" required>

                <label>Description:</label>
                <textarea id="description" rows="3"></textarea>

                <label>Choose MIDI File:</label>
                <input type="file" id="file" accept=".mid" required>

                <div class="btn-group">
                    <button type="button" onclick="uploadMidi('save')">Save JSON</button>
                    <button type="button" onclick="uploadMidi('savePublish')">Save & Publish MQTT</button>
                </div>
            </form>
            <div id="result"></div>
        </div>
    </div>

    <script>
        window.BAND_WS_URL = 'ws://localhost:8080/ws/status';
    </script>

    <script src="js/script.js"></script>
    <script src="js/midiUpload.js"></script>
    <script src="js/midi.js"></script>
    <script src="js/play.js"></script>
    <script src="js/realtime-play.js"></script>
</div>
</body>
</html>
